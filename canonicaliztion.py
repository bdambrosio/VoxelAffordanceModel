"""
Translates this:
{
  "radius": 10,
  "center": {
    "x": -156,
    "y": 71,
    "z": -98
  },
  "cells": {
    "-149,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5462313
    },
    "-149,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.546295
    },
    "-149,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5463653
    },
    "-149,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.546414
    },
    "-148,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5464585
    },
    "-148,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5465012
    },
    "-150,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5465612
    },
    "-150,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.546604
    },
    "-149,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5466435
    },
    "-149,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5466955
    },
    "-148,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5467489
    },
    "-148,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.546808
    },
    "-150,71,-100": {
      "name": "minecraft:short_grass",
      "ts": 1768603723.5468595
    },
    "-150,70,-100": {
      "name": "minecraft:grass_block[snowy=false]",
      "ts": 1768603723.5469103
    },
    "-149,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.546967
    },
    "-149,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.547018
    },
    "-148,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.547078
    },
    "-148,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5471435
    },
    "-147,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5472002
    },
    "-147,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5472586
    },
    "-151,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603731.9857275
    },
    "-151,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603731.9858618
    },
    "-150,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5474396
    },
    "-150,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5474992
    },
    "-149,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5475686
    },
    "-149,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5476446
    },
    "-148,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5477066
    },
    "-148,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5477722
    },
    "-147,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5478632
    },
    "-147,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.547936
    },
    "-146,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5480015
    },
    "-146,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5480804
    },
    "-151,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5481536
    },
    "-151,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5482183
    },
    "-150,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.548294
    },
    "-150,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5484169
    },
    "-149,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5485494
    },
    "-149,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5486648
    },
    "-148,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5487545
    },
    "-148,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.548853
    },
    "-147,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.548943
    },
    "-147,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5490568
    },
    "-146,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5491884
    },
    "-146,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5493019
    },
    "-152,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603731.9906924
    },
    "-152,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603731.9908566
    },
    "-151,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5496497
    },
    "-151,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5497372
    },
    "-150,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5498214
    },
    "-150,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5499141
    },
    "-149,71,-104": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.550012
    },
    "-149,70,-104": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5501065
    },
    "-148,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5502074
    },
    "-148,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.550301
    },
    "-147,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5504045
    },
    "-147,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5505044
    },
    "-146,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.550611
    },
    "-146,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5507324
    },
    "-153,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603733.1393611
    },
    "-153,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603733.1396077
    },
    "-152,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5512538
    },
    "-152,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.551383
    },
    "-151,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.551493
    },
    "-151,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5515985
    },
    "-150,71,-104": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5517173
    },
    "-150,70,-104": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.551828
    },
    "-149,71,-105": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5519304
    },
    "-149,70,-105": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.552032
    },
    "-148,71,-104": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.552141
    },
    "-148,70,-104": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.552246
    },
    "-147,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5523536
    },
    "-147,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5524662
    },
    "-146,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603723.5525706
    },
    "-146,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603723.5526767
    },
    "-151,72,-98": {
      "name": "air",
      "ts": 1768603733.1263494
    },
    "-151,73,-98": {
      "name": "air",
      "ts": 1768603733.1266205
    },
    "-150,72,-98": {
      "name": "air",
      "ts": 1768603731.9822567
    },
    "-150,73,-98": {
      "name": "air",
      "ts": 1768603731.9826424
    },
    "-150,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603731.9835184
    },
    "-150,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603731.983665
    },
    "-151,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603733.1277854
    },
    "-151,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603733.1280632
    },
    "-152,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2703412
    },
    "-152,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2706187
    },
    "-151,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603731.9843237
    },
    "-151,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603731.9844682
    },
    "-151,71,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603731.9845994
    },
    "-151,70,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603731.9847343
    },
    "-153,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603735.6926525
    },
    "-153,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603735.6929996
    },
    "-152,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603733.1295757
    },
    "-152,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603733.129999
    },
    "-152,71,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603733.1304324
    },
    "-152,70,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603733.1308446
    },
    "-151,71,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603731.9859953
    },
    "-151,70,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603731.986136
    },
    "-154,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.850711
    },
    "-154,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.8510475
    },
    "-153,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.27258
    },
    "-153,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2728891
    },
    "-153,71,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2731965
    },
    "-153,70,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2735162
    },
    "-152,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603733.1334336
    },
    "-152,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603733.13368
    },
    "-152,71,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603733.133927
    },
    "-152,70,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603733.1341658
    },
    "-155,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0124817
    },
    "-155,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.0129051
    },
    "-154,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603735.6948452
    },
    "-154,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603735.6951604
    },
    "-154,71,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603735.695557
    },
    "-154,70,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603735.695879
    },
    "-153,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2757185
    },
    "-153,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2760007
    },
    "-153,71,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2762885
    },
    "-153,70,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2765734
    },
    "-152,71,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603731.991016
    },
    "-152,70,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603731.9912493
    },
    "-156,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1789956
    },
    "-156,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1794386
    },
    "-155,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.8527782
    },
    "-155,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.8531082
    },
    "-155,71,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.8534498
    },
    "-155,70,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.8537772
    },
    "-154,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2784948
    },
    "-154,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2787755
    },
    "-154,71,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2790768
    },
    "-154,70,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2793536
    },
    "-153,71,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603733.1398547
    },
    "-153,70,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603733.1400952
    },
    "-157,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1798685
    },
    "-157,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.180282
    },
    "-156,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0147572
    },
    "-156,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.01512
    },
    "-156,71,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0154939
    },
    "-156,70,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.015851
    },
    "-155,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.8560464
    },
    "-155,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.8563664
    },
    "-155,71,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.8566902
    },
    "-155,70,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.8570082
    },
    "-154,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2824512
    },
    "-154,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.282715
    },
    "-154,71,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.283013
    },
    "-154,70,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2833147
    },
    "-153,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603731.997057
    },
    "-153,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603731.9974055
    },
    "-153,71,-94": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603731.997613
    },
    "-153,70,-94": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603731.9978082
    },
    "-158,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1807296
    },
    "-158,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1811388
    },
    "-157,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.181525
    },
    "-157,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1819592
    },
    "-157,71,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1823552
    },
    "-157,70,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1827395
    },
    "-156,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0185354
    },
    "-156,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.0188928
    },
    "-156,71,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0192442
    },
    "-156,70,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.019616
    },
    "-155,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603735.7048087
    },
    "-155,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603735.705114
    },
    "-155,71,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603735.7054935
    },
    "-155,70,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603735.70599
    },
    "-154,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.287315
    },
    "-154,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.287581
    },
    "-154,71,-94": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.287842
    },
    "-154,70,-94": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2881024
    },
    "-153,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603732.0020328
    },
    "-153,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603732.0022426
    },
    "-153,71,-93": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603732.0024617
    },
    "-153,70,-93": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603732.0026803
    },
    "-159,71,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.183107
    },
    "-159,70,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1834898
    },
    "-158,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.183912
    },
    "-158,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1842847
    },
    "-158,71,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1846793
    },
    "-158,70,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1850655
    },
    "-157,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1854856
    },
    "-157,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1858673
    },
    "-157,71,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1862338
    },
    "-157,70,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.186652
    },
    "-156,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.8639965
    },
    "-156,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.864333
    },
    "-156,71,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.8646712
    },
    "-156,70,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.8649988
    },
    "-155,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2922037
    },
    "-155,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2924812
    },
    "-155,71,-94": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2927513
    },
    "-155,70,-94": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.293081
    },
    "-154,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603733.15285
    },
    "-154,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603733.1530848
    },
    "-154,71,-93": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603733.153319
    },
    "-154,70,-93": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603733.153565
    },
    "-152,72,-98": {
      "name": "air",
      "ts": 1768603734.2688975
    },
    "-152,73,-98": {
      "name": "air",
      "ts": 1768603734.2691813
    },
    "-160,70,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1870224
    },
    "-160,69,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1874044
    },
    "-159,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1877723
    },
    "-159,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.188167
    },
    "-159,71,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1886206
    },
    "-159,70,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1890125
    },
    "-158,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.189394
    },
    "-158,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1897693
    },
    "-158,71,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.190188
    },
    "-158,70,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1905794
    },
    "-157,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0286942
    },
    "-157,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.029207
    },
    "-157,71,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0296862
    },
    "-157,70,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.0301173
    },
    "-156,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.8701208
    },
    "-156,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.8705583
    },
    "-156,71,-94": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.8709514
    },
    "-156,70,-94": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.871287
    },
    "-155,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2981696
    },
    "-155,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.298431
    },
    "-155,71,-93": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603734.2986896
    },
    "-155,70,-93": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603734.2989461
    },
    "-153,72,-98": {
      "name": "air",
      "ts": 1768603735.690951
    },
    "-153,73,-98": {
      "name": "air",
      "ts": 1768603735.6912901
    },
    "-161,70,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.190995
    },
    "-161,69,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1913886
    },
    "-160,71,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1918159
    },
    "-160,70,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1922104
    },
    "-160,70,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.19263
    },
    "-160,69,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1930726
    },
    "-159,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1934717
    },
    "-159,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.193847
    },
    "-159,70,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1942167
    },
    "-159,69,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1945958
    },
    "-158,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1949625
    },
    "-158,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1953306
    },
    "-158,71,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1957018
    },
    "-158,70,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.196065
    },
    "-157,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0360186
    },
    "-157,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.0363712
    },
    "-157,71,-94": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.036717
    },
    "-157,70,-94": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.0371082
    },
    "-156,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603735.721711
    },
    "-156,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603735.722002
    },
    "-156,71,-93": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603735.722292
    },
    "-156,70,-93": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603735.7226112
    },
    "-154,72,-98": {
      "name": "air",
      "ts": 1768603736.848995
    },
    "-154,73,-98": {
      "name": "air",
      "ts": 1768603736.849327
    },
    "-162,70,-98": {
      "name": "minecraft:short_grass",
      "ts": 1768603739.196438
    },
    "-162,69,-98": {
      "name": "minecraft:grass_block[snowy=false]",
      "ts": 1768603739.1968625
    },
    "-161,70,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1972458
    },
    "-161,69,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.197627
    },
    "-161,70,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1979985
    },
    "-161,69,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1983745
    },
    "-160,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1987777
    },
    "-160,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1991665
    },
    "-160,70,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.1995504
    },
    "-160,69,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.1999233
    },
    "-159,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.200327
    },
    "-159,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2009547
    },
    "-159,71,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2014208
    },
    "-159,70,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2018104
    },
    "-158,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0423222
    },
    "-158,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.0426657
    },
    "-158,71,-94": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0430017
    },
    "-158,70,-94": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.0433395
    },
    "-157,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.883641
    },
    "-157,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.8839593
    },
    "-157,71,-93": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603736.8842826
    },
    "-157,70,-93": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603736.884606
    },
    "-155,72,-98": {
      "name": "air",
      "ts": 1768603738.0095794
    },
    "-155,73,-98": {
      "name": "air",
      "ts": 1768603738.0102196
    },
    "-163,70,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2022982
    },
    "-163,69,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2027168
    },
    "-162,70,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.203085
    },
    "-162,69,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2034695
    },
    "-162,70,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2038379
    },
    "-162,69,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.204206
    },
    "-161,71,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2045767
    },
    "-161,70,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2049422
    },
    "-161,70,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2053092
    },
    "-161,69,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.205679
    },
    "-160,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2060404
    },
    "-160,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2064266
    },
    "-160,70,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.206792
    },
    "-160,69,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2071497
    },
    "-159,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2075145
    },
    "-159,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.207878
    },
    "-159,71,-94": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.208241
    },
    "-159,70,-94": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2086117
    },
    "-158,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0499928
    },
    "-158,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.0503333
    },
    "-158,71,-93": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603738.0506792
    },
    "-158,70,-93": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603738.0510252
    },
    "-156,72,-98": {
      "name": "air",
      "ts": 1768603739.177024
    },
    "-156,73,-98": {
      "name": "air",
      "ts": 1768603739.1774137
    },
    "-164,70,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2089934
    },
    "-164,69,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2093673
    },
    "-163,70,-99": {
      "name": "minecraft:short_grass",
      "ts": 1768603739.209736
    },
    "-163,69,-99": {
      "name": "minecraft:grass_block[snowy=false]",
      "ts": 1768603739.2101028
    },
    "-163,70,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.210473
    },
    "-163,69,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2108402
    },
    "-162,70,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2112067
    },
    "-162,69,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.211662
    },
    "-162,70,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2120516
    },
    "-162,69,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.212432
    },
    "-161,71,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.212804
    },
    "-161,70,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2131767
    },
    "-161,70,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2135534
    },
    "-161,69,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2139728
    },
    "-160,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2143831
    },
    "-160,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2147713
    },
    "-160,70,-94": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2151492
    },
    "-160,69,-94": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.215595
    },
    "-159,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2161934
    },
    "-159,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2168536
    },
    "-159,71,-93": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2172604
    },
    "-159,70,-93": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2176375
    },
    "-157,72,-98": {
      "name": "air",
      "ts": 1768603739.1759214
    },
    "-157,73,-98": {
      "name": "air",
      "ts": 1768603739.1765723
    },
    "-165,70,-98": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.218039
    },
    "-165,69,-98": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.218434
    },
    "-164,70,-99": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.218811
    },
    "-164,69,-99": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.21918
    },
    "-164,70,-97": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2195573
    },
    "-164,69,-97": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2199283
    },
    "-163,70,-100": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2203038
    },
    "-163,69,-100": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2207236
    },
    "-163,70,-96": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2211232
    },
    "-163,69,-96": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2215345
    },
    "-162,70,-101": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2219296
    },
    "-162,69,-101": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.222361
    },
    "-162,70,-95": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2227786
    },
    "-162,69,-95": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2231762
    },
    "-161,71,-102": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.2235727
    },
    "-161,70,-102": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.2240245
    },
    "-161,70,-94": {
      "name": "minecraft:short_grass",
      "ts": 1768603739.2246447
    },
    "-161,69,-94": {
      "name": "minecraft:grass_block[snowy=false]",
      "ts": 1768603739.2252982
    },
    "-160,71,-103": {
      "name": "minecraft:snow[layers=1]",
      "ts": 1768603739.225801
    },
    "-160,70,-103": {
      "name": "minecraft:grass_block[snowy=true]",
      "ts": 1768603739.226197
    },
    "-160,69,-93": {
      "name": "minecraft:stone",
      "ts": 1768603739.2266006
    }
  }
}'

into:

{
  "pos": [x, y, z],
  "age_s": 0.12,

  "block": {
    "id": "grass_block",
    "namespace": "minecraft",
    "props": { "snowy": "true" }
  },

  "geom": {
    "occupancy": "solid|air|fluid|replaceable|unknown",
    "support": true,
    "head_obstacle": false,
    "thin_layer": false,
    "passable": false
  },

  "material": {
    "class": "stone|dirt|wood|plant|snow|water|lava|generic",
    "hazard": "none|drowning|burn|suffocation|fall_trigger",
    "breakability": "unbreakable|breakable",
    "tool_hint": "none|pickaxe|shovel|axe|shears"
  }
}
"""
"""
canonicalization.py

Deterministic canonicalization of a sparse Minecraft local_grid
into canonical voxel features suitable for perception.

This module performs NO learning, NO physics inference beyond
block-type semantics, and NO neighborhood reasoning.

It normalizes raw block names + properties into a stable,
compact feature vocabulary.
"""

from dataclasses import dataclass
from typing import Dict, Any, List, Tuple, Optional
import time


@dataclass
class CanonicalCell:
    pos: Tuple[int, int, int]
    age_s: float
    block: Dict[str, Any]
    geom: Dict[str, Any]
    material: Dict[str, Any]


class Canonicalization:
    """
    Canonicalization of raw local_grid input into CanonicalCells.

    Input contract (assumed):
      {
        "radius": int,
        "center": {"x":int,"y":int,"z":int},
        "cells": {
            "x,y,z": {
                "name": "minecraft:block[prop=val,...]" | "air",
                "ts": float
            },
            ...
        }
      }
    """

    # ---- block classification tables (v0) ----

    REPLACEABLE_IDS = {
        "short_grass",
        "tall_grass",
        "fern",
        "large_fern",
        "dead_bush",
        "grass",
        "seagrass",
    }

    FLUID_IDS = {"water", "lava"}

    MATERIAL_CLASS = {
        # dirt-like
        "grass_block": "dirt",
        "dirt": "dirt",
        "coarse_dirt": "dirt",
        "podzol": "dirt",

        # stone-like
        "stone": "stone",
        "cobblestone": "stone",
        "deepslate": "stone",

        # snow / plant
        "snow": "snow",
        "short_grass": "plant",
        "tall_grass": "plant",
    }

    TOOL_HINT = {
        "stone": "pickaxe",
        "dirt": "shovel",
        "snow": "shovel",
        "plant": "none",
        "generic": "none",
    }

    HAZARD = {
        "water": "drowning",
        "lava": "burn",
    }

    # ---- public API ----

    def canonicalize(self, local_grid: Dict[str, Any]) -> Dict[str, Any]:
        """
        Main entry point.
        Returns a CanonicalGrid dict with normalized cells.
        """

        raw_cells = local_grid.get("cells", {})
        if not raw_cells:
            return self._empty_grid(local_grid)

        frame_ts = max(cell["ts"] for cell in raw_cells.values())
        canonical_cells: List[CanonicalCell] = []

        for key, cell in raw_cells.items():
            pos = self._parse_pos(key)
            name = cell["name"]
            age_s = max(0.0, frame_ts - cell["ts"])

            namespace, block_id, props = self._parse_block_name(name)

            geom = self._derive_geom(block_id, props)
            material = self._derive_material(block_id)

            canonical_cells.append(
                CanonicalCell(
                    pos=pos,
                    age_s=age_s,
                    block={
                        "namespace": namespace,
                        "id": block_id,
                        "props": props,
                    },
                    geom=geom,
                    material=material,
                )
            )

        return {
            "cvs_version": "0",
            "center": (
                local_grid["center"]["x"],
                local_grid["center"]["y"],
                local_grid["center"]["z"],
            ),
            "radius": local_grid["radius"],
            "frame_ts": frame_ts,
            "cells": [cell.__dict__ for cell in canonical_cells],
        }

    # ---- parsing helpers ----

    def _parse_pos(self, key: str) -> Tuple[int, int, int]:
        x, y, z = key.split(",")
        return int(x), int(y), int(z)

    def _parse_block_name(self, name: str) -> Tuple[str, str, Dict[str, str]]:
        if name == "air":
            return "minecraft", "air", {}

        namespace, rest = name.split(":", 1)

        if "[" not in rest:
            return namespace, rest, {}

        block_id, prop_str = rest.split("[", 1)
        prop_str = prop_str.rstrip("]")
        props = {}

        if prop_str:
            for kv in prop_str.split(","):
                if "=" in kv:
                    k, v = kv.split("=", 1)
                    props[k] = v

        return namespace, block_id, props

    # ---- deterministic derivations ----

    def _derive_geom(self, block_id: str, props: Dict[str, str]) -> Dict[str, Any]:
        """
        Derive geometric / collision semantics.
        """

        # occupancy
        if block_id == "air":
            occupancy = "air"
        elif block_id in self.FLUID_IDS:
            occupancy = "fluid"
        elif block_id in self.REPLACEABLE_IDS:
            occupancy = "replaceable"
        else:
            occupancy = "solid"

        # thin snow layers
        thin_layer = False
        if block_id == "snow" and "layers" in props:
            try:
                thin_layer = int(props["layers"]) < 8
            except ValueError:
                thin_layer = False

        # support / passability
        if occupancy == "air":
            support = False
            passable = True
            head_obstacle = False
        elif occupancy == "fluid":
            support = False
            passable = True
            head_obstacle = False
        elif occupancy == "replaceable":
            support = False
            passable = True
            head_obstacle = False
        elif thin_layer:
            support = True
            passable = True
            head_obstacle = False
        else:
            support = True
            passable = False
            head_obstacle = True

        return {
            "occupancy": occupancy,
            "support": support,
            "passable": passable,
            "head_obstacle": head_obstacle,
            "thin_layer": thin_layer,
        }

    def _derive_material(self, block_id: str) -> Dict[str, Any]:
        """
        Derive material class, hazard, breakability, tool hint.
        """

        material_class = self.MATERIAL_CLASS.get(block_id, "generic")

        hazard = self.HAZARD.get(block_id, "none")

        if block_id in ("air", "water", "lava"):
            breakability = "unbreakable"
        else:
            breakability = "breakable"

        tool_hint = self.TOOL_HINT.get(material_class, "none")

        return {
            "class": material_class,
            "hazard": hazard,
            "breakability": breakability,
            "tool_hint": tool_hint,
        }

    # ---- utilities ----

    def _empty_grid(self, local_grid: Dict[str, Any]) -> Dict[str, Any]:
        return {
            "cvs_version": "0",
            "center": (
                local_grid["center"]["x"],
                local_grid["center"]["y"],
                local_grid["center"]["z"],
            ),
            "radius": local_grid["radius"],
            "frame_ts": time.time(),
            "cells": [],
        }
